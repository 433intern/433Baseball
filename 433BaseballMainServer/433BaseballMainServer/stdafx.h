#pragma once

#define INTERNAL_SUPPRESS_PROTOBUF_FIELD_DEPRECATION

#pragma warning(disable : 4002)
#pragma warning(disable : 4996)

#include "targetver.h"

#pragma comment(lib, "ws2_32.lib")
#pragma comment(lib, "Mswsock.lib")

#include <stdio.h>
#include <tchar.h>
#include <string>
#include <wchar.h>
#include <stdlib.h>

#include <WinSock2.h>
#include <WS2tcpip.h>
#include <MSWSock.h>

#include <Windows.h>

#include <iostream>
#include <vector>
#include <queue>
#include <fstream>
#include <process.h>

#include <mysql.h>

#include <algorithm>

#include <google/protobuf/stubs/common.h>
#include <google/protobuf/stubs/once.h>
#include <google/protobuf/io/coded_stream.h>
#include <google/protobuf/wire_format_lite_inl.h>
#include <google/protobuf/descriptor.h>
#include <google/protobuf/generated_message_reflection.h>
#include <google/protobuf/reflection_ops.h>
#include <google/protobuf/wire_format.h>

#if GOOGLE_PROTOBUF_VERSION < 2006000
#error This file was generated by a newer version of protoc which is
#error incompatible with your Protocol Buffer headers.  Please update
#error your headers.
#endif
#if 2006001 < GOOGLE_PROTOBUF_MIN_PROTOC_VERSION
#error This file was generated by an older version of protoc which is
#error incompatible with your Protocol Buffer headers.  Please
#error regenerate this file with a newer version of protoc.
#endif

//----------------------------------------------------

#define SERVERPORT					8000
#define DB_PORT						3306
#define BUFSIZE						1024
#define SOCKET_POOL_SIZE			3000
#define HEADER_SIZE					10
#define WAIT_AVAILABLE_HANDLE_TIME	100
#define WAIT_AVAILABLE_SOCKET_TIME	100
#define DB_THREAD_POOL_SIZE			4
#define DB_HANDLE_POOL_SIZE			8

//----------------------------------------------------

struct CGlobalManager;

class CLogWriter;

template <class entity_type>
class State;
template <class entity_type>
class StateMachine;

class CWaitResponse;
class CWaitMessage;

class CDBClosed;
class CDBIdle;
class CDBWaitResult;

class CDBManager;

class CClientManager;

class CActor;

struct CConnector;
struct CDisconnector;
struct CReceiver;
struct CSender;
struct CAcceptor;

struct CDBConnector;
struct CDBDisconnector;
struct CDBQuerier;

struct CProactor;

struct CSockInfo;
struct CClientSocket;

struct CDBHandle;

struct CAct;

struct CClientAct;
struct CDBAct;

#define MYERRORPRINTF(A) CGlobalManager::GetInstance().logWriter.MyErrorPrintf(A, typeid(this).name(), __FUNCTION__)
#define MYSERVICEERRORPRINTF(A) CGlobalManager::GetInstance().logWriter.MyServiceErrorPrintf(A, __FUNCTION__)
#define MYDBERRORPRINTF(A,B) CGlobalManager::GetInstance().logWriter.MyDBErrorPrintf(A,B, __FUNCTION__)
#define MYPRINTF(A) CGlobalManager::GetInstance().logWriter.MyPrintf(A)

#include "RoomPacket.PROTO.pb.h"
#include "IngamePacket.PROTO.pb.h"

#include "Utils.h"

#include "LogWriter.h"

#include "GlobalManager.h"

#include "Act.h"
#include "ClientAct.h"
#include "DBAct.h"

#include "State.h"
#include "StateMachine.h"

#include "SockInfo.h"
#include "ClientSocket.h"
#include "ListenSocket.h"

#include "DBHandle.h"

#include "Actor.h"

#include "Connector.h"
#include "Disconnector.h"
#include "Sender.h"
#include "Receiver.h"
#include "Acceptor.h"

#include "DBConnector.h"
#include "DBDisconnector.h"
#include "DBQuerier.h"

#include "Proactor.h"

#include "DBManager.h"
#include "ClientManager.h"

#include "ClientSocketStates.h"
#include "DBHandleStates.h"